% ****** Start of file template-FFR120-FYM120-blindtext.tex ******
%
% use on Overleaf!!!!
%
\documentclass[%
 reprint,
 amsmath,amssymb,
 aps,
]{revtex4-2}

\usepackage{graphicx}% Include figure files
% \usepackage{dcolumn}% Align table columns on decimal point
\usepackage{bm}% bold math
\usepackage{hyperref}% add hypertext capabilities
% \usepackage{array} % for better column types
\usepackage{caption} % optional for better captions
\usepackage{tabularx}
%\usepackage[mathlines]{lineno}% Enable numbering of text and display math
%\linenumbers\relax % Commence numbering lines
\usepackage{xcolor}

\usepackage{lipsum}

\begin{document}

\title{[T2.1] Characterizing Shortest-Path Ensembles for Brain Network Modeling \\ Using Empirical Constraints}% Force line breaks with \\

\author{Daniel PeÃ±a Fonseca}
\author{Lukas Prader}

\date{\today}% It is always \today, today,
             %  but any date may be explicitly specified

\begin{abstract} %%% DO NOT CHANGE!
%%% - B1 - %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%% Customize this part: text between - B1 - and - E1 - must not appear in the final report 
\noindent
Understanding how anatomical pathways manage the flow of information in the human brain remains a fundamental challenge in (network) neuroscience. Parametric models, particularly the Shortest Path Ensembles (SPE), provide a framework for simulating communication between different Regions of interest (ROIs) not only through the shortest route, but also through a set of alternatives (near-shortest paths) based on model parameters. The number and relative weighing of these near-shortest paths that would best approximate empirical results remain unknown. Conceptually, a small number of allowed paths captures the biological intuition that brain communication makes use of structural information to use optimal routing, while a large number of allowed paths describes a transmission without the use of any encoded structural information. Using structural connectomes and then simulating signal outputs over time, this report addresses this question by varying the number of paths considered to determine which range minimizes discrepancies between empirical data (connectomes and functional MRIs) and simulated results.
%%% - E1 - %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{description} %%% DO NOT CHANGE!
\item[Project Topic] %%% DO NOT CHANGE!
{Brain Network Modelling} %CHANGE accordingly
\item[Teaching Assistant] %%% DO NOT CHANGE!
{Yu-Wei Chang} % CHANGE accordingly
\end{description} %%% DO NOT CHANGE!
\end{abstract}

\maketitle




\section{\label{sec:intro}Introduction} %%% DO NOT CHANGE!

%%% - B2 - %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%% Customize this part: text between - B2 - and - E2 - must not appear in the final report 

Understanding how information propagates between brain regions is a central challenge in neuroscience.
Structural connectivity, as mapped through Diffusion Tensor Imaging (DTI), encodes the pathways that information can flow through when propagating from one Region of Interest (ROI) to another.
Multiple studies have shown that the strength and structure of white-matter routes are tightly linked to functional coupling along the cortex \cite{white_matter}.
Network neuroscience offers a quantitative framework for studying these connections, using graph approaches to characterize how the brain's topology supports efficient, flexible and metabolically economical communication \cite{book_graph_brain}.

Decades of research have shown that the human connectome is neither random nor uniformly organized.
Instead, it exhibits characteristic properties such as small-world topology, combining high local clustering with additional long-range connections \cite{small_world_brain_networks}.
The network also contains highly connected hub regions, creating a structure supporting long-range communication, essential for efficient information propagation \cite{rich_club_original}\cite{rich_club_2}.
These architectural principles indicate that the connectome is optimized for dynamic information transfer, while operating under biological constraints, such as wiring cost and metabolic efficiency.

Against this structural background, an important challenge is to determine how information flows through the network; that is, from the brain's anatomical structure, determine how brain nodes are functionally correlated, which can be measured through functional MRI (fMRI).
Communication dynamics have been proposed as the missing link between structural and functional connectivity, providing mechanisms of how neural systems coordinate across spatially separated regions \cite{kshortest_original}.
Classical frameworks often assume either optimal routing, where signals follow the most efficient (shortest) path, or diffusive dynamics, where information flows stochastically according to local connectivity \cite{review_methods}.
% Particularly, random walk processes have been deeply explored, and serve as intuitive models for diffusion-like communication in neural systems \cite{random_walk}.

However, both extremes capture only certain aspects of real neural communication, and place assumptions about the nature of information flow.
In shortest-path routing, signals are assumed to have full knowledge of the global network structure, while diffusive models assume that regions have only local information to guide communication \cite{review_methods}.
Brain network topology actually achievs a balance between diffusion and routing efficiency due to the highly connected hubs present in the connectome \cite{review_brain_structure_and_function}.

Parametric models operate on the continuum between the diffusive and shortest-path routing extremes \cite{review_methods}, striking a trade-off between transmission cost and information cost.
Additionally, studies have shown that including alternative pathways can improve efficiency and strengthen robustness and resilience in brain networks \cite{review_brain_structure_and_function}, which are additional factors to consider for realistic models of neural communication.

Despite these insights, major gaps remain.
In particular, there is no consensus over which kinds of paths or how many should be used for a signal to travel between ROIs.
Seeking to answer these questions, in this study we investigate information transfer using a parametric model to capture the parameter values for which results from simulations based on structural connectomes most accurately reflect empirical patterns of brain activity.


%Despite these insights, major gaps remain. In particular, it is not yet clear how many near-shortest paths, or what weighting of such paths, most accurately reflects empirical patterns of brain activity. Real neural communication likely balances efficiency with redundancy, robustness, and limited knowledge about the global network structure. This motivates the use of parametric models, which enable systematic exploration of different communication regimes by varying key parameters. 

% In this study, we investigate information transfer using the Shortest Path Ensembles (SPE) model, a parametric framework that allows signals to traverse not only the shortest path between two regions but also a set of near-shortest alternatives. By continuously varying the number of allowed paths, the model spans communication regimes ranging from highly informed, efficient routing to minimally informed, diffuse propagation. Using structural connectomes and simulated time-resolved signal propagation, we examine which ranges of the SPE parameter best approximate empirical functional connectivity patterns derived from fMRI. Through this approach, we aim to clarify how the brain may flexibly combine efficiency and redundancy to support large-scale information flow.




\section{\label{sec:overview}Overview} %%% DO NOT CHANGE!

%%% - B3 - %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%% Customize this part: text between - B3 - and - E3 - must not appear in the final report 
\noindent


% With the goal of exploring the relation of structural connections between brain regions to functional correlations in brain activity,%

Connectome data can be used to simulate brain activity based on a range of Brain Network Communication Models (BNCMs) \cite{review_methods}.\
When wanting to explore the impact of available information on the performance of communication models, parametric models provide a flexible framework due to their tunable parameters.
They enable specific parameter tuning, which can give insights into how strongly different trade offs (e.g. efficiency vs transmission cost) should be considered to match empirical observations.
Examples of this type of framework include linear threshold models \cite{linear_threshold}, biased random walks \cite{biased_random_walk} and shortest path ensembles \cite{kshortest_original}.
A common property among them is their ability to tune how far the model should lean towards diffusion-type models or shortest-path approaches by changing parameters.

In order to determine the method most suitable for our research question, the features and specific use case scenarios for each of them need to be compared (see Table \ref{tab:methodsoverview}).

\onecolumngrid
\begin{table*}[t]
\caption{\textbf{Overview of simulation methods and metrics.}}
\label{tab:methodsoverview}

\begin{tabular*}{\textwidth}{|c|c|c|c|}
    \hline
    \textbf{Method / Model} & \textbf{Use case scenario} & \textbf{Features} & \textbf{Suitable for the project?} \\
    \hline
    \parbox[t]{0.125\linewidth}{Linear threshold model} &
    \parbox[t]{0.305\linewidth}{looking at signal propagation based on the state of neighbouring nodes} &
    \parbox[t]{0.19\linewidth}{neighbour transmission threshold} &
    \parbox[t]{0.318\linewidth}{uses activation state to determine propagation, focused on direct structural influence} \\
    \hline
    \parbox[t]{0.125\linewidth}{Biased random walk} & 
    \parbox[t]{0.305\linewidth}{investigating the potential impact of structural information on random walk dynamics} &
    \parbox[t]{0.19\linewidth}{transition bias, amount of structural information allowed to influence random transitions} &
    \parbox[t]{0.318\linewidth}{can be used to study the concrete relationship between structural properties and patterns in time correlation} \\
    \hline
    \parbox[t]{0.125\linewidth}{Shortest path ensembles} & 
    \parbox[t]{0.305\linewidth}{analysing behaviour related to perturbations of the optimal path and the relevance of the optimal path in relation to other alternatives} &
    \parbox[t]{0.19\linewidth}{number of next shortest paths $k$} &
    \parbox[t]{0.318\linewidth}{can be used to closely explore differences in efficiency between paths related to, but deviating from optimal (ideal) path routing} \\
    \hline
\end{tabular*}

\end{table*}
\twocolumngrid

{\bf Method 1 (Linear threshold models).} 
In this approach, signal propagation is determined by the number of neighbouring nodes that have already received the signal \cite{linear_threshold}.
Each node in the network will receive the information only if $n$ (or more) of its neighbours have previously received the transmission, making $n$ the tunable parameter of the model.
With $n=1$, each node with at least one activated neighbour will receive the signal, resulting in maximal diffusion through broadcasting.
Increasing $n$, the conditions for activation become progressively stricter, reducing the propagation along the network.
For $n$ sufficiently large, information flow can reach a bottleneck, reflecting a regime in which only tightly clustered neighbourhoods can participate in transmission.


{\bf Method 2 (Biased random walks).} 
In unbiased random walks, the probability of a signal propagating from node $i$ to node $j$ is proportional to the connection weight between these nodes.
Alternatively, in biased random walks, transition probabilities are additionally influenced by the amount of global topological information available to individual nodes.
This is controlled by the tunable parameter $\lambda$ \cite{review_methods}\cite{biased_random_walk}. With $\lambda=0$, unbiased random walks are recovered, since individual nodes will only posses information regarding their own connections \cite{random_walk}.
In contrast, for $\lambda \to \infty$, the biased random walk converges to the shortest path, since each transmission between every two nodes will contain the entire global topological information, leading to optimal paths \cite{book_graph_brain}.


{\bf Method 3 (Shortest path ensembles).} 
This parametric model considers that signals between two brain regions do not only travel along the most efficient route, but through the $k$ most efficient paths (sorted by length) \cite{kshortest_original}.
Standard shortest-path routing is recovered setting $k=1$, while $k \to \infty$ implies diffusive communication since all possible paths would be considered.
Small values of $k$, would require extensive global topological knowledge of the network, while larger values of $k$ would relax these conditions, resulting in smaller informational cost \cite{review_methods}.
Since SPE is a relaxation of shortest path routing, many metrics and methods applicable to shortest path routing can be adapted to SPE.

All three methods can be considered suitable for the research question, as they allow to change the kinds of paths allowed for communication by varying their respective parameters.

More discussion of suitability here...


%%% - E3 - %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%




\section{\label{sec:method}Method} %%% DO NOT CHANGE!

%%% - B4 - %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%% Customize this part: text between - B4 - and - E4 - must not appear in the final report 
\begin{figure*}
    \centering
    \includegraphics[width=\textwidth]{workflow.png}
    \caption{{\bf Method overview.} The illustrated workflow summarizes the steps taken to simulate and evaluate the shortest-path ensemble model against empirical brain data for all patients. Structural connectivity matrices from DTI and fMRI time series from the provided dataset are used as inputs.
    SC matrices are used to derive the k-distance matrices for $k$ ranging from 1 to 50. The obtained distance matrices are then used as coupling matrices in the Kuramoto model to simulate brain activity over time, resulting in simulated functional connectivity (FC) matrices. Empirical FC matrices are computed from the fMRI time series using Pearson correlation. Finally, the simulated FC matrices are compared to the empirical FC matrices using Pearson correlation to assess model performance across different values of $k$.
    }
    \label{workflow}
\end{figure*}


{\color{red} somwhere I would like to add a plot of the atlas locations that we used, we also have to explain in detail what the data is that we used, maybe this is also in methods?}

\noindent
To investigate how information propagates between brain regions, a parametric communication model offers a flexible approach. By tuning a model parameter and observing how the resulting simulations align with empirical data, we can detect the range of parameter values that best reproduces real behavior; and therefore, determine which communication regime is closer to the human brain's dynamics.
Starting from the brain's structural connectivity, we simulate information transmission following the selected model and then compare the simulated outcomes with empirical observations using multiple metrics. Trying to capture a broad variety of communication behaviours, we selected the shortest-path ensemble model as our brain network communication model. 

%In order to study a wide range of behaviour with one model, the use of a parametric model was chosen as the brain network communication model. In particular, it was decided to use the shortest path ensemble approach. Several metrics will be used to characterize the behaviour of this communication method.
{\bf Shortest path ensembles (SPE).} {

{\color{red} we use k distance metric mainly, so maybe rename to k distance, explain interpretation and motivation in detail.}

This model proposes that a signal propagating from one region to another, can only do so through one of the \textit{k} shortest paths (ensemble) \cite{kshortest_original}. Following the SPE model, each route $i$ will be assigned a probability $P_i$ of the signal communicating through it according to its connection-distance length $d_i$ \cite{kprobabilities}. To assign higher probabilities to shorter routes, probabilities will be defined as follows:
\begin{equation}
    P_i=\frac{1/d_i}{\sum_{i=1}^k (1/d_i)}
    \label{probabilities_eq}
\end{equation}

With $d_i=-\log \left( \sum_jw_{j\to j+1}\right)$, where $w_{j\to j+1} \in (0,1)$ indicates the connection degree between the node $j$ and the next node $j+1$; nodes that belong to the path $i$ (possibly) traveled by the signal \cite{kshortest_original}.

This parametric model allows an analysis dependent on the size of the ensemble. Modifying the number of shortest paths considered, \textit{k}, the metrics presented afterwards will be studied, in order to find the range of \textit{k}-values for which the empirical results are most faithfully reproduced. 

While other processes generally present high energy or information costs, SPE not only preserves low delay costs, but also prevents other costs from rising.
In addition, SPE allows to compare the presence and impact of time delay by comparing paths within the ensemble to each other, making it possible to explore the structural properties which shape the propagation of signals in the proximity of efficient (shortest path) and inefficient (detour) communication routes.

[Discuss the use case scenarios of the method, their features with advantages and disadvantages / strong and weak points, and whether it is more or less suitable for the research question. It is a good idea to reference the literature.]} 

{\bf Functional Correlation (FC).} {In brain-network modelling, this procedure is commonly used to measures the correlation structure of activity time series across brain regions, generally using an FC matrix \cite{general_methods}. Where each element of the matrix is the Pearson correlation coefficient between the time series of two brain regions. With this metric, an exhaustive comparison between empirical outcomes and simulated results will be performed. Although this measure does not cover all the characteristics of a brain's network, it works as a general reference for different ROIs' correlation.}

{\bf Kuramoto Model (KM).} {This is a mathematical framework commonly used to describe collective synchronization in populations of coupled oscillators with varied natural frequencies. Considering each brain region as an oscillator, the coupling between nodes is justified by the brain connections (grey matter), allowing the usage of the Kuramoto model for brain-signal communication \cite{kuramoto-eq}. Defining $\theta(t)$ as the phase (frequency) of node $n$ at time $t$, the following equation is satisfied:}

\begin{equation}
    \frac{d \theta_n}{dt} = \omega_n + c\cdot \sum_{p=1}^{N} C_{np}\cdot \sin{ \left(\theta_p (t-\tau_{np}) -\theta_n(t)\right)} + \xi\cdot\eta_n(t)
\end{equation}

Where $n$ represents the node index: $n=1,...,N$. The term $\omega_n$ represents the intrinsic angular frequency, satisfying $\omega_n=2\pi \nu_n$, where $\nu_n$ represents a fixed Gaussian distribution $\mathcal{N}(60Hz, \sigma_f^2)$. $C_{np}$ is the relative coupling strength from node $p$ to node $n$, and $\xi$ is the global coupling scale, which scales all connection strengths. The delay between node $p$'s information emission, and node $n$'s reception is measured through $\tau_{np}$, which depends on the distance between the nodes. Defining $L_{np}$ as the distance matrix, and the average distance between nodes as $\langle L\rangle$, $k$; the delay is defined as $\tau_{np}=\langle \tau_{np}\rangle L_{np} /\langle L\rangle$; where $\langle \tau \rangle =11$ms. Lastly, $\xi$ represents the noise factor, accompanied by the term $\eta_n(t)$, indicating the noise received by local networks, corresponding to uncorrelated Gaussian white noise with zero mean, and $\sigma^2=x$. Since this study studies the effect of considering different $k$ shortest paths to define the functional correlation between brain regions, the coupling matrix $C$ and the distance matrix $L$ will be dependent on $k$. Reasonably, $C_{np}=1/L_{np}$ $\forall n,p$, since the further apart two nodes are from each other, the less coupled they will be \cite{kuramoto-eq}. 

{\color{red} Maybe I will add "BOLD" conversion, this is converting the kuramoto output to the signal that is actually measured by the fMRI using Baloon-Windkessel method, I have some code for that but not sure if it will work}


% We could say the good and bad parts after describing the methods.



[Discuss the use case scenarios of the method, their features with advantages and disadvantages / strong and weak points, and whether it is more or less suitable for the research question. It is a good idea to reference the literature]

{\bf Dataset.} {The provided dataset contains structural connectivity (SC) matrices obtained with measurements from Diffusion Tensor Imaging (DTI) and z-score time series from functional Magnetic Resonance Imaging (fMRI) data, from 100 healthy participants \cite{braph2}. The measurements concern 246 brain regions of interest (ROIs) defined by the Brainnetome atlas \cite{fan2016brainnetome}. % (see Fig. \ref{fig:brain_atlas_views} for a visualization of the atlas centroids).
The time series were used to compute empirical functional connectivity matrices via Pearson correlation. These empirical FC matrices serve as ground truth for evaluating the performance of the shortest-path ensemble model in simulating brain activity.
Figure \ref{fig:avg_sc_fc} shows the average of all SC and FC matrices in the dataset, illustrating the nature of the dataset.


\begin{figure}
    \centering
    \includegraphics[width=\columnwidth]{../project_SOCS_code/figures/averaged_sc_fc.png}
    \caption{\textbf{Averaged SC and FC matrix.} Matrices showing the averaged structural connectivity (A) and functional connectivity (B) over all patients. Color describes the connection strength or functional correlation between two ROIs respectively.}
    \label{fig:avg_sc_fc}
\end{figure}


% \begin{figure}
%     \centering
%     \includegraphics[width=0.9\columnwidth]{../project_SOCS_code/figures/brain_atlas_views.png}
%     \caption{\textbf{Brain atlas views.} Visualization of the Brainnetome atlas showing the 246 brain regions of interest (ROIs).}
%     \label{fig:brain_atlas_views}
% \end{figure}

}


%{\bf Recurrent Quantification Analysis (RQA).} {With fMRIs in the form of time series, one can perform analyses on the recurrence of temporal patterns between ROIs. Recurrence plots and information theoretic measures can be used to compare different time series with each other \cite{webber2015recurrence} and will be used to compare simulated results with empirical data. These tools usually require domain specific knowledge in order to find good parameter values for the analysis.}

%{\bf Shannon Entropy Growth Curve.} {The Shannon entropy growth curve for a time series of states of a dynamical systems can be used to understand the temporal order of complexity of a system, showing the exact orders of time relevant to the behaviour of the system \cite{crutchfield2003regularities}. It calculates the block entropies for a time series and looks at changes in the growth behaviour. It has been used in applications related to Reinforcement Learning and general state estimation in Markov Processes. The possible estimation length of the growth curve depends highly on the system and the number of samples, since a naive maximum likelihood estimation is biased to underestimate the entropy.}
%%% - E4 - %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%





\section{\label{sec:results}Results and Discussion} %%% DO NOT CHANGE!

%%% - B5 - %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%% Customize this part: text between - B5 - and - E5 - must not appear in the final report 

Using Equation (), matrices containing the k-shortest distance between every ROI were calculated for each patient, with $k$ ranging from 1 to 50. Figure \ref{fig:kdist_panel} shows three example k-distance matrices ($k=1,5,25$), obtained by averaging over all patients. It can be seen that for increasing values of $k$, the matrices become more uniform in color. This suggests that once many paths are considered, ROIs become more similar in terms of their k-distance, as signals can propagate through many alternative routes, creating a diffusive regime. For lower values of $k$, the matrices show more structure, indicating that certain ROIs form well connected clusters, i.e. the regions around the index 150 and 200 (Fig. \ref{fig:kdist_panel}, top).

\begin{figure}
    \centering
    \includegraphics[width=0.9\columnwidth]{../project_SOCS_code/figures/averaged_k_dist_matrices.png}
    \caption{\textbf{Example k-distance matrices.} Three k-distance matrices showing k=1, 5 and 25, obtained by averaging over all patients. Color describes the k-distance between two ROIs.}
    \label{fig:kdist_panel}
\end{figure}


In order to show how the structure of the k-distance matrices relates to empirical functional connectivity, the Pearson correlation between both matrices was calculated for each patient.
The results were then plotted as the mean correlation and standard deviation as a function of $k$ (Fig. \ref{fig:kdist_vs_fc}).
The first thing to notice is the negative sign of the correlation values.
Since we correlate distance with functional correlation, this suggests that ROIs with higher k-distance between them exhibit lower functional correlation.
One can also observe clear k-dependence, with the strongest mean correlation at $k=1$ with $r \approx -0.129$, which is equivalent to single shortest path connections between ROIs.
For $k>1$ correlation is significantly lower, but has a stable plateau with $r \approx -0.125$ up to $k=10$, after which correlation decreases further, reaching $r \approx -0.1$ at $k=50$.
This implies that additional paths, if close to the shortest path, relate differently to functional connectivity than more distant paths.
The scale of the standard deviation indicates that there is considerable variability between patients, yet ANOVA confirms significant differences between the distributions of each $k$ with $p \ll 0.001$.

\begin{figure}[h!]
    \centering
    \includegraphics[width=\columnwidth]{../project_SOCS_code/figures/k_dist_correlation_vs_k.png}
    \caption{\textbf{Correlation of k-distance matrices and empirical FC.} Pearson correlation between k-distance matrices and empirical functional connectivity matrices for all patients, shown as the mean with standard deviation as error band.}
    \label{fig:kdist_vs_fc}
\end{figure}


The global coupling strength $c=18$ used in \cite{kuramoto-eq} had to be adapted depending on the number of connections in the used connectivity matrices (also done in \cite{general_methods}).
The optimization of the scaling factor with \texttt{scipy.optimize.scalar\_minimize} is shown in Figure \ref{fig:parameter_opt}, with the maximal correlation between simulated and empirical FC achieved with a scaling factor $f \approx 0.2098$. The $k$ values used for optimization (1,5,10,30) were chosen to put emphasis on the region of interest $k \leq 10$ and keep computation time low.

\begin{figure}[h!]
    \centering
    \includegraphics[width=\columnwidth]{../project_SOCS_code/figures/parameter_optimisation.png}
    \caption{\textbf{Parameter optimisation.} Optimisation results of the scaling parameter for the Kuramoto global coupling factor. Colored points show results for different values of k, each point is the mean of 3 repetitions. Black crosses show the average correlation of the tested k values.}
    \label{fig:parameter_opt}
\end{figure}

The optimal scaling factor scales the coupling strength to about one fifth of the original value, which is close to the ratio of the number of ROIs used in \cite{kuramoto-eq} (66) and the Brainnetome atlas (246).
This confirms that the optimal coupling strength depends on the number of connections in the connectivity matrix.


With the optimized scaling factor, simulations for a selection of $k$ values were performed for all patients and resulted in a set of simulated FC matrices for each patient.
Example simulations again using the averaged k-distance matrices over all patients for $k=1,5,25$ (Fig. \ref{fig:sim_fc_panel}) show clear differences compared to the empirical averaged FC (Fig. \ref{fig:avg_sc_fc} B).
While regions of high correlation like around index 200 are captured by the simulations, the size and distribution of these regions differ significantly.
It can also be observed that with increasing $k$, the simulated FC matrices become more uniform in color, similar to the k-distance matrices (Fig. \ref{fig:kdist_panel}).
Regions of high correlation in simulated FC generally seem to have matching regions of low distance in the k-distance matrices.
Direct pearson correlations between the averaged k-distance matrices and the averaged simulated FC matrices returned correlations of $-0.355$ for $k=1$, $-0.486$ for $k=5$, $-0.347$ for $k=25$, showing that even though there are similarities in structure, the simulated FC matrices differ significantly from the k-distance matrices and provide different information.

The simulated FC matrices were also compared to the empirical FC matrices per patient using Pearson correlation (Fig. \ref{fig:sim_vs_fc}).

\begin{figure}
    \centering
    \includegraphics[width=0.9\columnwidth]{../project_SOCS_code/figures/averaged_simulated_fc_matrices.png}
    \caption{\textbf{Example k-distance matrices.} Three simulated FC matrices showing k=1, 5 and 25, obtained by averaging over all patients. Color describes the k-distance between two ROIs.}
    \label{fig:sim_fc_panel}
\end{figure}

Results from simulation contrast those obtained from direct correlation of k-distance matrices with empirical FC (Fig. \ref{fig:kdist_vs_fc}), suggesting that actually not shortest path communication, but communication using k-distance coupling with $k=8$ achieves the highest (now positive since we correlate simulated FC with empirical FC) mean correlation with empirical FC at $r \approx 0.056$. The shortest path coupling ($k=1$) even has the lowest average correlation of all simulated $k$, only reaching $r = 0.032$
This indicates that actual brain dynamics may not rely solely on shortest path communication, but rather include a higher single digit combination of near-shortest paths.

\begin{figure}
    \centering
    \includegraphics[width=\columnwidth]{../project_SOCS_code/figures/simulation_correlation_vs_k.png}
    \caption{\textbf{Correlation of simulated FC and empirical FC.} Pearson correlation between simulated functional connectivity matrices and empirical functional connectivity matrices for all patients, shown as the mean with standard deviation as error bars.}
    \label{fig:sim_vs_fc}
\end{figure}


In order to further investigate the variability between patients, the best $k$ value (highest correlation) was determined for each patient, both for the direct k-distance to empirical FC correlation and for the simulated to empirical FC correlation.
These were then plotted as histograms (Fig. \ref{fig:best_k_hist}).
For the direct correlation of k-distance matrices with empirical FC (Fig. \ref{fig:best_k_hist} A), the distribution of best $k$ values peaks strongly at $k=1$, though with some individuals having optimal correlation around $k=8$.
One individual even has an optimal correlation at$k=49$, showing how different results can be even in healthy individuals.
For the simulated to empirical FC correlation (Fig. \ref{fig:best_k_hist} B), the distribution is more spread out than in the previous case.

\begin{figure}
    \centering
    \includegraphics[width=0.9\columnwidth]{../project_SOCS_code/figures/best_k_histograms.png}
    \caption{\textbf{Distribution of best k per patient.} Histograms showing the distribution of best k values per patient, for the correlation between k-distance matrices and empirical FC (A) and for the correlation between simulated FC and empirical FC (B).}
    \label{fig:best_k_hist}
\end{figure}

In individual counts, $k=10$ actually has the highest number of patients with optimal correlation, though followed closely by $k=8$, which had the highest average correlation (Fig. \ref{fig:sim_vs_fc}). 15 individuals have their optimal correlation at $k=25, 35$ or $50$, again showing the high variability between individuals.

%%% - E5 - %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{\label{sec:conclusion}Conclusions and Outlook} %%% DO NOT CHANGE!

%%% - B6 - %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%% Customize this part: text between - B6 - and - E6 - must not appear in the final report 
\noindent
\fbox{\parbox[t][][t]{\columnwidth}{
\textbf{Points:} \fbox{\bf \textcolor{magenta}{4}} out of \textbf{44}
}}


{\color{red} k distance always is the weighted value of all paths up to k, but maybe one should also just look at other combinations of paths, maybe k3 is not used but 4 and 6 etc. this is a limitation of what we did

kuramoto is a simplification, and we will not have simulated for the same timescales as the empirical measurements, this may be a problem with comparability, though I did ensure that the oscillators had stabilized within the time frame that i simulated

also in actuality we should convert the data that we get to BOLD signal, I have some code from a guy that supposedly does this, maybe i can still add that.}

The optimal parameters curently obtained for the model vary strongly depending on the k-distance matrix used, but they are mostly in the same order of magnitude as the ones proposed in \cite{kuramoto-eq}.

Further investigation will be conducted to see if the model can be improved to obtain statistically significant results.

The base correlation of the k-distance matrices against empirical FC is interesting due to the suggested additional importance of paths with length $\approx$ 5 in addition to shortest path signalling, which has the highest correlation.
%%% - E6 - %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%





\section{\label{sec:Contribution}Contributions} %%% DO NOT CHANGE!

%%% - B7 - %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%% Customize this part: text between - B7 - and - E7 - must not appear in the final report 
\noindent
Lukas Prader read the articles regarding the information propagation and implemented all the code needed for this project. Daniel P. Fonseca red  the articles regarding previous research in the field and wrote this article. Both authors, nevertheless, made valuable contributions for the complementary work. \textit{Note:} Due to a mistake when creating the GitHub repository, all of Daniel's contributions have been assigned to Lukas' profile.
%%% - E7 - %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\section{\label{sec:COI}Conflict of Interest} %%% DO NOT CHANGE!

%%% - B8 - %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%% Customize this part: text between - B8 - and - E8 - must not appear in the final report 
\noindent
The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.
%%% - E8 - %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%




\section{\label{sec:datacode}Data and Code Availability} %%% DO NOT CHANGE!

%%% - B9 - %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%% Customize this part: text between - B9 - and - E9 - must not appear in the final report 
\noindent
Data is available for download at \cite{braph2}. All source files (code and report) are made publicly available at \cite{code} .
%%% - E9 - %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%%% - B10 - %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%% Customize this part: text between - B10 - and - E10 - must not appear in the final report 
\noindent



\bibliography{biblio-FFR120-FYM119} %%% DO NOT CHANGE!
% Produces the bibliography via BibTeX.

\end{document}
